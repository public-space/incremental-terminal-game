"""
Help Screen
===========

Tutorial and command reference for colony.sh.
"""

import sys
import os

# Add engine to path
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.dirname(__file__))))

from engine import UIFramework, Color


class HelpScreen:
    """
    Help and tutorial screen.

    Displays game instructions, commands, and mechanics.
    """

    def __init__(self, ui: UIFramework):
        """
        Initialize help screen.

        Args:
            ui: UI framework instance
        """
        self.ui = ui

    def render(self):
        """Render help screen."""
        self.ui.clear_screen()

        # Header
        self.ui.print_colored(
            "â•”â•â•â• COLONY.SH HELP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—",
            Color.BRIGHT_CYAN
        )
        self.ui.print_colored(
            "â•‘ Survival Manual - Read carefully. Your life depends on it.           â•‘",
            Color.CYAN
        )
        self.ui.print_colored(
            "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",
            Color.BRIGHT_CYAN
        )

        # Objective
        self._render_section("OBJECTIVE", [
            "You command a frontier outpost on a dead world.",
            "Manage resources. Build structures. Research technology.",
            "Keep your colonists alive. Expand. Survive.",
            "",
            "Every Sol (day) brings new challenges.",
            "Energy is life. When it runs out, everything stops.",
        ])

        # Resources
        self._render_section("RESOURCES", [
            "âš¡ ENERGY  - Powers all systems. Generated by Solar Arrays.",
            "â› METAL   - Construction material. Mined from dead rock.",
            "ğŸ§¬ BIOMASS - Food for colonists. Recycled organic matter.",
            "ğŸ‘¤ COLONISTS - Your workforce. Fragile. Precious.",
        ])

        # Commands
        self._render_section("COMMANDS", [
            "[B] Build     - Construct structures (costs resources)",
            "[R] Research  - Unlock technologies (permanent upgrades)",
            "[I] Info      - View detailed statistics",
            "[H] Help      - Show this screen",
            "[S] Save      - Save your progress",
            "[Q] Quit      - Exit the game",
        ])

        # Tips
        self._render_section("SURVIVAL TIPS", [
            "â€¢ Balance energy production and consumption",
            "â€¢ Build Mining Rigs early to generate metal",
            "â€¢ Research upgrades to boost efficiency",
            "â€¢ Watch your biomass - colonists need food",
            "â€¢ Save often. Catastrophes happen.",
        ])

        # Footer
        self.ui.print_colored(
            "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",
            Color.BRIGHT_CYAN
        )
        self.ui.print_colored(
            "â•‘ Press [ENTER] to return                                               â•‘",
            Color.CYAN
        )
        self.ui.print_colored(
            "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•",
            Color.BRIGHT_CYAN
        )

        input()

    def _render_section(self, title: str, lines: list):
        """
        Render a help section.

        Args:
            title: Section title
            lines: List of content lines
        """
        # Section header
        self.ui.print_colored(f"â•‘ {title}", Color.BRIGHT_WHITE)
        self.ui.print_colored(
            "â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â•‘",
            Color.WHITE
        )

        # Content lines
        for line in lines:
            if line:
                self.ui.print_colored(f"â•‘   {line:<66} â•‘", Color.WHITE)
            else:
                print("â•‘" + " " * 70 + "â•‘")

        print()


# Example usage
if __name__ == "__main__":
    ui = UIFramework(use_colors=True)
    help_screen = HelpScreen(ui)

    print("Rendering help screen...\n")
    help_screen.render()

    print("\nâœ“ Help screen test complete!")
